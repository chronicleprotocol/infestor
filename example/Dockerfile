FROM golang:1-alpine

ARG SETZER_BRANCH="sc-413/setzer-configurable-endpoints"

RUN apk add --no-cache -X http://dl-cdn.alpinelinux.org/alpine/edge/testing \
  bash git datamash jq curl make jshon perl build-base ca-certificates

# Installing setzer
RUN git clone -b ${SETZER_BRANCH} https://github.com/makerdao/setzer-mcd.git \
  && cp -R setzer-mcd/libexec/setzer/ /root/setzer \
  && rm -rf setzer-mcd

ENV PATH="/root/setzer:${PATH}"

# TMP
ENV SMOCKER="http://smocker:8080"
# updating all available configs
ENV ORIGIN_THEGRAPH_URL=$SMOCKER
ENV ORIGIN_BINANCE_URL=$SMOCKER
ENV ORIGIN_BITFINEX_URL=$SMOCKER
ENV ORIGIN_BITSTAMP_URL=$SMOCKER
ENV ORIGIN_BITTHUMB_URL=$SMOCKER
ENV ORIGIN_BITTREX_URL=$SMOCKER
ENV ORIGIN_CMC_URL=$SMOCKER
ENV ORIGIN_COINBASE_URL=$SMOCKER
ENV ORIGIN_CRYPTOCOMPARE_URL=$SMOCKER
ENV ORIGIN_DDEX_URL=$SMOCKER
ENV ORIGIN_FTX_URL=$SMOCKER
ENV ORIGIN_FX_URL=$SMOCKER
ENV ORIGIN_GATEIO_URL=$SMOCKER
ENV ORIGIN_GEMINI_URL=$SMOCKER
ENV ORIGIN_HITBTC_URL=$SMOCKER
ENV ORIGIN_HUOBI_URL=$SMOCKER
ENV ORIGIN_KRAKEN_URL=$SMOCKER
ENV ORIGIN_KUCOIN_URL=$SMOCKER
ENV ORIGIN_KYBER_URL=$SMOCKER
ENV ORIGIN_OKEX_URL=$SMOCKER
ENV ORIGIN_POLONIEX_URL=$SMOCKER
ENV ORIGIN_UPBIT_URL=$SMOCKER

WORKDIR /app

COPY . /app

CMD ["/bin/bash"]